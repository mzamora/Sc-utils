function qs = qsat( T, P )

%% Define constants
Lv = 2.5e6; % [J / kg]
Rv = 461; % [J / kg K]

%% Compute q_sat

e_s = 611 .* exp( (Lv ./ Rv) .* ( 1 ./ 273 - 1 ./ T ) );

% Goff Gratch equation
% e_s = 10 .^ ( -7.90298 .* (373.16./T - 1) + 5.02808 .* log10(373.16 ./ T) - 1.3816 .* 10 .^ (-7) .* (10 .^ (11.344 .* (1 - T ./ 373.16)) - 1) + 8.1328 .^ 10 .^ (-3) .* (10 .^ (-3.49149 .* (373.16 ./ T - 1)) - 1) + log10(1013.246) );
% e_s = e_s .* 100;

% % CIMO guide
% e_s = 6.112 .* exp( 17.62 .* T ./ (243.12 + T) ) .* 100;

qs = 0.622 .* ( e_s ./ (P - e_s) );

end